# Claude Code 기능 활용 가이드

> 프로젝트: Telegram → Notion 자동 저장 봇 (Node.js)
> 작성일: 2026-02-01

---

## 개요

Claude Code에는 개발 효율을 높이는 여러 기능이 있다. 이 문서는 현재 프로젝트(telegram_resource)를 기준으로, 각 기능을 어디에 어떻게 쓸 수 있는지 정리한 것이다.

| 기능 | 한줄 설명 |
|------|----------|
| CLAUDE.md | 프로젝트 정보를 기억시키는 파일 |
| Hooks | 특정 이벤트 발생 시 자동으로 명령 실행 |
| Skills | 자주 쓰는 작업을 명령어로 등록 |
| MCP 서버 | 외부 도구(Notion, GitHub 등)를 Claude에 연결 |
| Settings | 권한, 환경변수 등 전반 설정 |

---

## 1. CLAUDE.md — 프로젝트 기억 파일

### 이게 뭔가?

CLAUDE.md는 프로젝트 루트에 놓는 마크다운 파일이다. Claude Code가 세션을 시작할 때 자동으로 읽어서, 프로젝트 구조·규칙·명령어 등을 매번 설명할 필요 없이 바로 이해한다.

### 현재 상태

❌ CLAUDE.md 파일 없음 → 매 세션마다 프로젝트를 처음부터 파악해야 함

### 적용 방법

프로젝트 루트에 `CLAUDE.md` 파일을 생성한다.

```
D:\개발 작업\telegram_resource\CLAUDE.md
```

### 추천 내용

```markdown
# Telegram Notion Bot

텔레그램 메시지를 Claude AI로 분석하여 Notion에 자동 저장하는 봇

## 기술 스택
- Node.js 20, Express, node-telegram-bot-api
- Notion API (@notionhq/client), Anthropic Claude API
- Jest (테스트), Replit (배포)

## 주요 명령어
- npm start — 봇 실행
- npm run dev — 개발 모드 (watch)
- npm test — 테스트 실행 (22개)

## 핵심 파일
- bot.js — 메인 봇 로직 (메시지 수신 → AI 분석 → Notion 저장)
- dedup-store.js — 중복 방지 저장소
- check-uptime.js — UptimeRobot 연결 확인
- tests/unit/ — 단위 테스트 4개 파일

## 코드 규칙
- 한글 커밋 메시지 사용
- CommonJS (require) 방식
- 콘솔 로그에 [PREFIX] 형식 사용 (예: [HANDLER], [DEDUP])

## 배포
- Replit (https://node-suite--tlsl111009.replit.app)
- UptimeRobot으로 5분 간격 헬스체크
- GitHub: https://github.com/yealu/telegram_resource_bot
```

### 효과

- 세션이 바뀌어도 Claude가 프로젝트를 정확히 이해
- 컨텍스트 압축(compaction) 후에도 핵심 정보 유지
- 코드 규칙을 일관되게 따름

### 난이도: ⭐ (쉬움)

---

## 2. Hooks — 자동 실행 워크플로우

### 이게 뭔가?

Hooks는 Claude Code에서 특정 이벤트가 발생할 때 자동으로 셸 명령을 실행하는 기능이다. "파일을 수정하면 → 테스트 돌리기" 같은 자동화를 설정할 수 있다.

### 주요 이벤트 종류

| 이벤트 | 발생 시점 | 활용 예 |
|--------|----------|--------|
| PostToolUse | 도구 실행 후 | 파일 수정 후 테스트 자동 실행 |
| PreToolUse | 도구 실행 전 | 위험한 작업 차단 |
| SessionStart | 세션 시작 시 | 프로젝트 상태 안내 |
| Notification | Claude가 사용자 입력 대기 시 | 알림 보내기 |
| Stop | Claude 응답 완료 시 | 작업 완료 확인 |

### 설정 위치

`.claude/settings.json` 또는 `.claude/settings.local.json` 내부에 추가한다.

---

### 사례 A: 파일 수정 후 자동 테스트 실행

**목적**: Claude가 코드를 수정할 때마다 22개 테스트가 자동으로 돌아간다. 깨진 테스트가 있으면 바로 알 수 있다.

**설정**:

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Edit|Write",
        "hooks": [
          {
            "type": "command",
            "command": "cd \"D:\\개발 작업\\telegram_resource\" && npm test 2>&1 | tail -5"
          }
        ]
      }
    ]
  }
}
```

**동작 흐름**:

```
Claude가 bot.js 수정 → Hook 자동 실행 → npm test → 결과를 Claude에게 전달
```

---

### 사례 B: .env 파일 보호 (읽기/수정 차단)

**목적**: Claude가 실수로 API 키가 담긴 .env 파일을 읽거나 수정하는 것을 원천 차단한다.

**설정**:

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Edit|Write|Read",
        "hooks": [
          {
            "type": "command",
            "command": "node -e \"const d=JSON.parse(require('fs').readFileSync(0,'utf8')); const f=d.tool_input?.file_path||''; if(f.includes('.env')&&!f.includes('.example')){console.error('BLOCKED: .env 파일 접근 차단');process.exit(2)}\""
          }
        ]
      }
    ]
  }
}
```

**동작 흐름**:

```
Claude가 .env 읽기 시도 → Hook이 가로챔 → exit 2로 차단 → Claude에게 "차단됨" 알림
```

---

### 사례 C: git commit 전 테스트 강제 통과

**목적**: 테스트가 실패하면 커밋이 되지 않는다.

**설정**:

```json
{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "node -e \"const d=JSON.parse(require('fs').readFileSync(0,'utf8')); const cmd=d.tool_input?.command||''; if(cmd.includes('git commit')){const r=require('child_process').execSync('cd \\\"D:\\\\개발 작업\\\\telegram_resource\\\" && npm test',{encoding:'utf8'}); if(!r.includes('passed')){console.error('테스트 실패! 커밋 차단');process.exit(2)}}\""
          }
        ]
      }
    ]
  }
}
```

**동작 흐름**:

```
Claude가 git commit 실행 → Hook이 먼저 npm test 실행 → 통과시 커밋 / 실패시 차단
```

### 난이도: ⭐⭐ (보통)

---

## 3. Skills — 반복 작업을 명령어로 등록

### 이게 뭔가?

Skills는 자주 하는 작업을 `/명령어` 형태로 등록해서 한 번에 실행하는 기능이다. 마크다운 파일 하나만 만들면 된다.

### 이미 사용 가능한 기본 Skills

| 명령어 | 용도 | 이 프로젝트에서 언제 쓰는지 |
|--------|------|--------------------------|
| `/commit` | Git 커밋 자동 생성 | 코드 수정 후 커밋 메시지 자동 작성 |
| `/code-review` | PR 코드 리뷰 | GitHub PR 올리기 전 코드 점검 |
| `/feature-dev` | 기능 개발 가이드 | 새 기능(예: 이미지 저장) 추가할 때 |

### 사용법

Claude Code에서 그냥 입력하면 된다:

```
/commit
/code-review
/feature-dev "카테고리 자동 태그 기능 추가"
```

---

### 커스텀 Skill 만들기

#### 사례 A: 봇 전체 진단 — `/bot-check`

**파일 위치**: `.claude/skills/bot-check/SKILL.md`

```yaml
---
name: bot-check
description: 텔레그램 봇 상태를 진단합니다.
user-invocable: true
---

봇 진단 체크리스트를 수행하세요:

1. node diagnosis/test-diagnosis-telegram.js 로 텔레그램 연결 확인
2. node diagnosis/test-diagnosis-claude.js 로 Claude API 확인
3. npm test 로 테스트 전체 실행
4. processed_messages.json 파일 크기와 항목 수 확인
5. .bot.lock 파일 상태 확인

결과를 한글로 표 형태로 정리해서 보여주세요.
```

**사용법**: `/bot-check` 입력

**효과**: 진단 스크립트 3개 + 테스트 + 상태 파일 확인을 한 번에 실행

---

#### 사례 B: 배포 전 체크리스트 — `/deploy-check`

**파일 위치**: `.claude/skills/deploy-check/SKILL.md`

```yaml
---
name: deploy-check
description: Replit 배포 전 체크리스트를 수행합니다.
user-invocable: true
---

배포 전 체크리스트:

1. npm test 실행 → 22개 테스트 모두 통과 확인
2. .env.example과 실제 필요한 환경변수 비교
3. git status로 커밋 안 된 변경 확인
4. node check-uptime.js 로 UptimeRobot 상태 확인
5. package.json 버전 확인

문제가 있으면 해결 방법을 제안하세요.
```

---

#### 사례 C: Notion 데이터 확인 — `/notion-check`

**파일 위치**: `.claude/skills/notion-check/SKILL.md`

```yaml
---
name: notion-check
description: Notion 데이터베이스 상태를 확인합니다.
user-invocable: true
---

Notion MCP 서버를 사용해서 다음을 확인하세요:

1. 데이터베이스에 저장된 최근 항목 5개 조회
2. 카테고리별 항목 수 확인
3. 중복 항목이 있는지 확인

결과를 한글로 정리해서 보여주세요.
```

### 난이도: ⭐⭐ (보통)

---

## 4. MCP 서버 — 외부 도구 연결

### 이게 뭔가?

MCP(Model Context Protocol)는 Claude Code에 외부 도구를 연결하는 기능이다. Notion API를 Claude가 직접 호출하거나, 브라우저를 자동 조작하는 것이 가능해진다.

### 현재 설정된 MCP

| MCP 서버 | 상태 | 용도 |
|----------|------|------|
| Notion API | ✅ 설정됨 | Notion 데이터베이스 조회/검색 |
| Context7 | ✅ 설정됨 | 라이브러리 공식 문서 검색 |
| Playwright | ✅ 설정됨 | 브라우저 자동 조작/테스트 |

### 추가로 쓸 수 있는 MCP

#### GitHub MCP — Issue/PR 관리

**설치**:

```bash
claude mcp add --transport http github https://api.githubcopilot.com/mcp/
```

**활용 예시**:

- "최근 이슈 목록 보여줘"
- "PR #3 리뷰해줘"
- "버그 리포트 이슈 만들어줘"

#### Playwright MCP — Express 서버 테스트

이미 설정되어 있으므로, 다음처럼 활용 가능:

```
"localhost:3000 접속해서 헬스체크 응답이 정상인지 확인해줘"
```

**동작 흐름**:

```
Claude → Playwright로 브라우저 열기 → localhost:3000 접속 → 응답 확인 → 결과 보고
```

### 난이도: ⭐⭐ (보통)

---

## 5. Settings — 권한과 환경 설정

### 이게 뭔가?

Claude Code가 어떤 명령을 실행할 수 있는지, 어떤 파일을 읽을 수 있는지 제어하는 설정이다.

### 설정 파일 위치

| 파일 | 범위 | Git에 올리나? |
|------|------|-------------|
| `~/.claude/settings.json` | 모든 프로젝트 | ❌ |
| `.claude/settings.json` | 이 프로젝트 (팀 공유) | ✅ |
| `.claude/settings.local.json` | 이 프로젝트 (개인) | ❌ |

### 현재 문제점

현재 `.claude/settings.local.json`에 두 가지 문제가 있다:

1. **권한이 너무 세분화되어 있음** — 40개 넘는 개별 규칙이 나열
2. **Notion API 토큰이 평문으로 노출** — 파일이 유출되면 토큰도 유출

### 개선된 설정 예시

```json
{
  "permissions": {
    "allow": [
      "Bash(npm *)",
      "Bash(node *)",
      "Bash(git *)",
      "Bash(tasklist *)",
      "Bash(taskkill *)",
      "Bash(tree *)",
      "Bash(dir *)"
    ],
    "deny": [
      "Bash(rm -rf *)",
      "Bash(del /s *)",
      "Read(*/.env)"
    ]
  }
}
```

### 보안 권장사항

- `.claude/settings.local.json`이 `.gitignore`에 포함되어 있는지 확인할 것
- API 토큰은 환경변수로 관리할 것 (설정 파일에 직접 쓰지 않기)

### 난이도: ⭐ (쉬움)

---

## 적용 우선순위 요약

| 순서 | 기능 | 난이도 | 효과 | 소요 작업 |
|------|------|--------|------|----------|
| 1 | CLAUDE.md 생성 | ⭐ | 매 세션 시간 절약 | 파일 1개 생성 |
| 2 | `/commit` 활용 | ⭐ | 커밋 메시지 자동화 | 설정 없이 바로 사용 |
| 3 | Settings 정리 | ⭐ | 권한 관리 깔끔하게 | 기존 파일 수정 |
| 4 | 자동 테스트 Hook | ⭐⭐ | 코드 수정 시 즉시 버그 감지 | settings에 Hook 추가 |
| 5 | .env 보호 Hook | ⭐⭐ | 보안 강화 | settings에 Hook 추가 |
| 6 | `/bot-check` Skill | ⭐⭐ | 진단 자동화 | SKILL.md 파일 1개 생성 |
| 7 | `/deploy-check` Skill | ⭐⭐ | 배포 실수 방지 | SKILL.md 파일 1개 생성 |
| 8 | GitHub MCP 추가 | ⭐⭐ | Issue/PR 관리 자동화 | 명령어 1줄 실행 |
